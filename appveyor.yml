image: ubuntu
version: '0.0.{build}'

dotnet_csproj:
  patch: true
  file: '**\*.csproj'
  version: '{version}'
  package_version: '{version}'
  assembly_version: '{version}'
  file_version: '{version}'
  informational_version: '{version}'
  
  before_build:
    - dotnet restore ./Carter.SirenNegotiator.sln 
  
  build_script:
    - dotnet build --no-restore ./src/Carter.SirenNegotiator.csproj
    - dotnet build --no-restore ./sample/Carter.SirenNegotiator.Sample.csproj
  
  before_deploy:
    - dotnet pack -o ../nupkgs --no-build --no-restore ./src/Carter.SirenNegotiator.csproj    
  
  deploy:
    provider: NuGet
    api_key:
      secure: %NUGET_API_KEY%
    artifact: ./nupkgs/*.nupkg